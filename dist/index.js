"use strict";var _Object$defineProperty = require("@babel/runtime-corejs3/core-js-stable/object/define-property");var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault");_Object$defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _promise = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/promise"));var _setTimeout2 = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/set-timeout"));var _map = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/map"));var _values = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/values"));var _express = _interopRequireDefault(require("express"));
var _cors = _interopRequireDefault(require("cors"));
var _helmet = _interopRequireDefault(require("helmet"));
var _mongoose = _interopRequireDefault(require("mongoose"));
var _swaggerUiExpress = _interopRequireDefault(require("swagger-ui-express"));
var _yamljs = _interopRequireDefault(require("yamljs"));
var _path = _interopRequireDefault(require("path"));


var _rateLimit = require("./middleware/rateLimit");
var _errors = require("./utils/errors");
var _metrics = require("./utils/metrics");
var _cache = require("./utils/cache");


var _analytics = _interopRequireDefault(require("./services/analytics")); // Import middleware
// Import routes
// Load OpenAPI specification
const swaggerDocument = _yamljs.default.load(_path.default.join(__dirname, 'docs/openapi.yaml'));

// Initialize Express app
const app = (0, _express.default)();
const PORT = process.env.PORT || 3005;

// Initialize rate limiters
const rateLimiters = _rateLimit.RateLimiter.createLimiters();

// Initialize caches
const caches = _cache.Cache.createCaches();

// Basic security middleware
app.use((0, _helmet.default)());
app.use((0, _cors.default)());

// Metrics middleware
app.use(_metrics.metricsMiddleware);

// Apply rate limiting
app.use('/analytics/track', rateLimiters.analyticsLimiter);
app.use('/analytics/batch', rateLimiters.batchLimiter);
app.use('/analytics/query', rateLimiters.queryLimiter);
app.use(rateLimiters.defaultLimiter); // Default rate limit for other routes

// API Documentation
app.use('/docs', _swaggerUiExpress.default.serve, _swaggerUiExpress.default.setup(swaggerDocument));

// Health check endpoint
app.get('/health', (req, res) => {
  res.status(200).json({
    status: 'UP',
    service: 'analytics-service',
    timestamp: new Date().toISOString(),
    version: process.env.npm_package_version
  });
});

// Metrics endpoint
app.get('/metrics', _metrics.metricsHandler);

// Analytics routes
app.use('/analytics', _analytics.default);

// Error handling
app.use(_errors.errorHandler);

// Connect to MongoDB with retry logic
const connectWithRetry = async (retries = 5, interval = 5000) => {
  for (let i = 0; i < retries; i++) {
    try {
      await _mongoose.default.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/spendsync_analytics', {
        serverSelectionTimeoutMS: 5000,
        socketTimeoutMS: 45000
      });
      console.log('Connected to MongoDB');
      break;
    } catch (err) {
      console.error(`MongoDB connection attempt ${i + 1} failed:`, err);
      if (i === retries - 1) {
        console.error('Max retries reached. Exiting...');
        process.exit(1);
      }
      await new _promise.default((resolve) => (0, _setTimeout2.default)(resolve, interval));
    }
  }
};

// Graceful shutdown
const gracefulShutdown = async () => {
  console.log('Received shutdown signal');

  // Close MongoDB connection
  try {
    await _mongoose.default.connection.close();
    console.log('MongoDB connection closed');
  } catch (err) {
    console.error('Error closing MongoDB connection:', err);
  }

  // Close Redis connections
  try {var _context, _context2;
    const redisClients = [
    ...(0, _map.default)(_context = (0, _values.default)(caches)).call(_context, (cache) => cache.redis),
    ...(0, _map.default)(_context2 = (0, _values.default)(rateLimiters)).call(_context2, (limiter) => limiter.redis)];

    await _promise.default.all((0, _map.default)(redisClients).call(redisClients, (client) => client.quit()));
    console.log('Redis connections closed');
  } catch (err) {
    console.error('Error closing Redis connections:', err);
  }

  // Exit process
  process.exit(0);
};

// Handle shutdown signals
process.on('SIGTERM', gracefulShutdown);
process.on('SIGINT', gracefulShutdown);

// Start server
if (process.env.NODE_ENV !== 'test') {
  connectWithRetry().then(() => {
    app.listen(PORT, () => {
      console.log(`Analytics Service running on port ${PORT}`);
      console.log(`Documentation available at http://localhost:${PORT}/docs`);
      console.log(`Health check available at http://localhost:${PORT}/health`);
      console.log(`Metrics available at http://localhost:${PORT}/metrics`);
    });
  });
}var _default = exports.default =

app;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2NvcnMiLCJfaGVsbWV0IiwiX21vbmdvb3NlIiwiX3N3YWdnZXJVaUV4cHJlc3MiLCJfeWFtbGpzIiwiX3BhdGgiLCJfcmF0ZUxpbWl0IiwiX2Vycm9ycyIsIl9tZXRyaWNzIiwiX2NhY2hlIiwiX2FuYWx5dGljcyIsInN3YWdnZXJEb2N1bWVudCIsIllBTUwiLCJsb2FkIiwicGF0aCIsImpvaW4iLCJfX2Rpcm5hbWUiLCJhcHAiLCJleHByZXNzIiwiUE9SVCIsInByb2Nlc3MiLCJlbnYiLCJyYXRlTGltaXRlcnMiLCJSYXRlTGltaXRlciIsImNyZWF0ZUxpbWl0ZXJzIiwiY2FjaGVzIiwiQ2FjaGUiLCJjcmVhdGVDYWNoZXMiLCJ1c2UiLCJoZWxtZXQiLCJjb3JzIiwibWV0cmljc01pZGRsZXdhcmUiLCJhbmFseXRpY3NMaW1pdGVyIiwiYmF0Y2hMaW1pdGVyIiwicXVlcnlMaW1pdGVyIiwiZGVmYXVsdExpbWl0ZXIiLCJzd2FnZ2VyVWkiLCJzZXJ2ZSIsInNldHVwIiwiZ2V0IiwicmVxIiwicmVzIiwic3RhdHVzIiwianNvbiIsInNlcnZpY2UiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ2ZXJzaW9uIiwibnBtX3BhY2thZ2VfdmVyc2lvbiIsIm1ldHJpY3NIYW5kbGVyIiwiYW5hbHl0aWNzUm91dGVzIiwiZXJyb3JIYW5kbGVyIiwiY29ubmVjdFdpdGhSZXRyeSIsInJldHJpZXMiLCJpbnRlcnZhbCIsImkiLCJtb25nb29zZSIsImNvbm5lY3QiLCJNT05HT0RCX1VSSSIsInNlcnZlclNlbGVjdGlvblRpbWVvdXRNUyIsInNvY2tldFRpbWVvdXRNUyIsImNvbnNvbGUiLCJsb2ciLCJlcnIiLCJlcnJvciIsImV4aXQiLCJfcHJvbWlzZSIsImRlZmF1bHQiLCJyZXNvbHZlIiwiX3NldFRpbWVvdXQyIiwiZ3JhY2VmdWxTaHV0ZG93biIsImNvbm5lY3Rpb24iLCJjbG9zZSIsIl9jb250ZXh0IiwiX2NvbnRleHQyIiwicmVkaXNDbGllbnRzIiwiX21hcCIsIl92YWx1ZXMiLCJjYWxsIiwiY2FjaGUiLCJyZWRpcyIsImxpbWl0ZXIiLCJhbGwiLCJjbGllbnQiLCJxdWl0Iiwib24iLCJOT0RFX0VOViIsInRoZW4iLCJsaXN0ZW4iLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgY29ycyBmcm9tICdjb3JzJztcbmltcG9ydCBoZWxtZXQgZnJvbSAnaGVsbWV0JztcbmltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5pbXBvcnQgc3dhZ2dlclVpIGZyb20gJ3N3YWdnZXItdWktZXhwcmVzcyc7XG5pbXBvcnQgWUFNTCBmcm9tICd5YW1sanMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cbi8vIEltcG9ydCBtaWRkbGV3YXJlXG5pbXBvcnQgeyBSYXRlTGltaXRlciB9IGZyb20gJy4vbWlkZGxld2FyZS9yYXRlTGltaXQnO1xuaW1wb3J0IHsgZXJyb3JIYW5kbGVyIH0gZnJvbSAnLi91dGlscy9lcnJvcnMnO1xuaW1wb3J0IHsgbWV0cmljc01pZGRsZXdhcmUsIG1ldHJpY3NIYW5kbGVyIH0gZnJvbSAnLi91dGlscy9tZXRyaWNzJztcbmltcG9ydCB7IENhY2hlIH0gZnJvbSAnLi91dGlscy9jYWNoZSc7XG5cbi8vIEltcG9ydCByb3V0ZXNcbmltcG9ydCBhbmFseXRpY3NSb3V0ZXMgZnJvbSAnLi9zZXJ2aWNlcy9hbmFseXRpY3MnO1xuXG4vLyBMb2FkIE9wZW5BUEkgc3BlY2lmaWNhdGlvblxuY29uc3Qgc3dhZ2dlckRvY3VtZW50ID0gWUFNTC5sb2FkKHBhdGguam9pbihfX2Rpcm5hbWUsICdkb2NzL29wZW5hcGkueWFtbCcpKTtcblxuLy8gSW5pdGlhbGl6ZSBFeHByZXNzIGFwcFxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuY29uc3QgUE9SVCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwNTtcblxuLy8gSW5pdGlhbGl6ZSByYXRlIGxpbWl0ZXJzXG5jb25zdCByYXRlTGltaXRlcnMgPSBSYXRlTGltaXRlci5jcmVhdGVMaW1pdGVycygpO1xuXG4vLyBJbml0aWFsaXplIGNhY2hlc1xuY29uc3QgY2FjaGVzID0gQ2FjaGUuY3JlYXRlQ2FjaGVzKCk7XG5cbi8vIEJhc2ljIHNlY3VyaXR5IG1pZGRsZXdhcmVcbmFwcC51c2UoaGVsbWV0KCkpO1xuYXBwLnVzZShjb3JzKCkpO1xuXG4vLyBNZXRyaWNzIG1pZGRsZXdhcmVcbmFwcC51c2UobWV0cmljc01pZGRsZXdhcmUpO1xuXG4vLyBBcHBseSByYXRlIGxpbWl0aW5nXG5hcHAudXNlKCcvYW5hbHl0aWNzL3RyYWNrJywgcmF0ZUxpbWl0ZXJzLmFuYWx5dGljc0xpbWl0ZXIpO1xuYXBwLnVzZSgnL2FuYWx5dGljcy9iYXRjaCcsIHJhdGVMaW1pdGVycy5iYXRjaExpbWl0ZXIpO1xuYXBwLnVzZSgnL2FuYWx5dGljcy9xdWVyeScsIHJhdGVMaW1pdGVycy5xdWVyeUxpbWl0ZXIpO1xuYXBwLnVzZShyYXRlTGltaXRlcnMuZGVmYXVsdExpbWl0ZXIpOyAvLyBEZWZhdWx0IHJhdGUgbGltaXQgZm9yIG90aGVyIHJvdXRlc1xuXG4vLyBBUEkgRG9jdW1lbnRhdGlvblxuYXBwLnVzZSgnL2RvY3MnLCBzd2FnZ2VyVWkuc2VydmUsIHN3YWdnZXJVaS5zZXR1cChzd2FnZ2VyRG9jdW1lbnQpKTtcblxuLy8gSGVhbHRoIGNoZWNrIGVuZHBvaW50XG5hcHAuZ2V0KCcvaGVhbHRoJywgKHJlcSwgcmVzKSA9PiB7XG4gIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICBzdGF0dXM6ICdVUCcsXG4gICAgc2VydmljZTogJ2FuYWx5dGljcy1zZXJ2aWNlJyxcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICB2ZXJzaW9uOiBwcm9jZXNzLmVudi5ucG1fcGFja2FnZV92ZXJzaW9uXG4gIH0pO1xufSk7XG5cbi8vIE1ldHJpY3MgZW5kcG9pbnRcbmFwcC5nZXQoJy9tZXRyaWNzJywgbWV0cmljc0hhbmRsZXIpO1xuXG4vLyBBbmFseXRpY3Mgcm91dGVzXG5hcHAudXNlKCcvYW5hbHl0aWNzJywgYW5hbHl0aWNzUm91dGVzKTtcblxuLy8gRXJyb3IgaGFuZGxpbmdcbmFwcC51c2UoZXJyb3JIYW5kbGVyKTtcblxuLy8gQ29ubmVjdCB0byBNb25nb0RCIHdpdGggcmV0cnkgbG9naWNcbmNvbnN0IGNvbm5lY3RXaXRoUmV0cnkgPSBhc3luYyAocmV0cmllcyA9IDUsIGludGVydmFsID0gNTAwMCkgPT4ge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHJldHJpZXM7IGkrKykge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBtb25nb29zZS5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJIHx8ICdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L3NwZW5kc3luY19hbmFseXRpY3MnLCB7XG4gICAgICAgIHNlcnZlclNlbGVjdGlvblRpbWVvdXRNUzogNTAwMCxcbiAgICAgICAgc29ja2V0VGltZW91dE1TOiA0NTAwMCxcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2coJ0Nvbm5lY3RlZCB0byBNb25nb0RCJyk7XG4gICAgICBicmVhaztcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYE1vbmdvREIgY29ubmVjdGlvbiBhdHRlbXB0ICR7aSArIDF9IGZhaWxlZDpgLCBlcnIpO1xuICAgICAgaWYgKGkgPT09IHJldHJpZXMgLSAxKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ01heCByZXRyaWVzIHJlYWNoZWQuIEV4aXRpbmcuLi4nKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfVxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGludGVydmFsKSk7XG4gICAgfVxuICB9XG59O1xuXG4vLyBHcmFjZWZ1bCBzaHV0ZG93blxuY29uc3QgZ3JhY2VmdWxTaHV0ZG93biA9IGFzeW5jICgpID0+IHtcbiAgY29uc29sZS5sb2coJ1JlY2VpdmVkIHNodXRkb3duIHNpZ25hbCcpO1xuXG4gIC8vIENsb3NlIE1vbmdvREIgY29ubmVjdGlvblxuICB0cnkge1xuICAgIGF3YWl0IG1vbmdvb3NlLmNvbm5lY3Rpb24uY2xvc2UoKTtcbiAgICBjb25zb2xlLmxvZygnTW9uZ29EQiBjb25uZWN0aW9uIGNsb3NlZCcpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjbG9zaW5nIE1vbmdvREIgY29ubmVjdGlvbjonLCBlcnIpO1xuICB9XG5cbiAgLy8gQ2xvc2UgUmVkaXMgY29ubmVjdGlvbnNcbiAgdHJ5IHtcbiAgICBjb25zdCByZWRpc0NsaWVudHMgPSBbXG4gICAgICAuLi5PYmplY3QudmFsdWVzKGNhY2hlcykubWFwKGNhY2hlID0+IGNhY2hlLnJlZGlzKSxcbiAgICAgIC4uLk9iamVjdC52YWx1ZXMocmF0ZUxpbWl0ZXJzKS5tYXAobGltaXRlciA9PiBsaW1pdGVyLnJlZGlzKVxuICAgIF07XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwocmVkaXNDbGllbnRzLm1hcChjbGllbnQgPT4gY2xpZW50LnF1aXQoKSkpO1xuICAgIGNvbnNvbGUubG9nKCdSZWRpcyBjb25uZWN0aW9ucyBjbG9zZWQnKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2xvc2luZyBSZWRpcyBjb25uZWN0aW9uczonLCBlcnIpO1xuICB9XG5cbiAgLy8gRXhpdCBwcm9jZXNzXG4gIHByb2Nlc3MuZXhpdCgwKTtcbn07XG5cbi8vIEhhbmRsZSBzaHV0ZG93biBzaWduYWxzXG5wcm9jZXNzLm9uKCdTSUdURVJNJywgZ3JhY2VmdWxTaHV0ZG93bik7XG5wcm9jZXNzLm9uKCdTSUdJTlQnLCBncmFjZWZ1bFNodXRkb3duKTtcblxuLy8gU3RhcnQgc2VydmVyXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICd0ZXN0Jykge1xuICBjb25uZWN0V2l0aFJldHJ5KCkudGhlbigoKSA9PiB7XG4gICAgYXBwLmxpc3RlbihQT1JULCAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgQW5hbHl0aWNzIFNlcnZpY2UgcnVubmluZyBvbiBwb3J0ICR7UE9SVH1gKTtcbiAgICAgIGNvbnNvbGUubG9nKGBEb2N1bWVudGF0aW9uIGF2YWlsYWJsZSBhdCBodHRwOi8vbG9jYWxob3N0OiR7UE9SVH0vZG9jc2ApO1xuICAgICAgY29uc29sZS5sb2coYEhlYWx0aCBjaGVjayBhdmFpbGFibGUgYXQgaHR0cDovL2xvY2FsaG9zdDoke1BPUlR9L2hlYWx0aGApO1xuICAgICAgY29uc29sZS5sb2coYE1ldHJpY3MgYXZhaWxhYmxlIGF0IGh0dHA6Ly9sb2NhbGhvc3Q6JHtQT1JUfS9tZXRyaWNzYCk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5leHBvcnQgZGVmYXVsdCBhcHA7ICJdLCJtYXBwaW5ncyI6InFyQkFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxLQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxPQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxTQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxpQkFBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUssT0FBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sS0FBQSxHQUFBUCxzQkFBQSxDQUFBQyxPQUFBOzs7QUFHQSxJQUFBTyxVQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxPQUFBLEdBQUFSLE9BQUE7QUFDQSxJQUFBUyxRQUFBLEdBQUFULE9BQUE7QUFDQSxJQUFBVSxNQUFBLEdBQUFWLE9BQUE7OztBQUdBLElBQUFXLFVBQUEsR0FBQVosc0JBQUEsQ0FBQUMsT0FBQSwwQkFBbUQsQ0FQbkQ7QUFNQTtBQUdBO0FBQ0EsTUFBTVksZUFBZSxHQUFHQyxlQUFJLENBQUNDLElBQUksQ0FBQ0MsYUFBSSxDQUFDQyxJQUFJLENBQUNDLFNBQVMsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDOztBQUU1RTtBQUNBLE1BQU1DLEdBQUcsR0FBRyxJQUFBQyxnQkFBTyxFQUFDLENBQUM7QUFDckIsTUFBTUMsSUFBSSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsSUFBSSxJQUFJLElBQUk7O0FBRXJDO0FBQ0EsTUFBTUcsWUFBWSxHQUFHQyxzQkFBVyxDQUFDQyxjQUFjLENBQUMsQ0FBQzs7QUFFakQ7QUFDQSxNQUFNQyxNQUFNLEdBQUdDLFlBQUssQ0FBQ0MsWUFBWSxDQUFDLENBQUM7O0FBRW5DO0FBQ0FWLEdBQUcsQ0FBQ1csR0FBRyxDQUFDLElBQUFDLGVBQU0sRUFBQyxDQUFDLENBQUM7QUFDakJaLEdBQUcsQ0FBQ1csR0FBRyxDQUFDLElBQUFFLGFBQUksRUFBQyxDQUFDLENBQUM7O0FBRWY7QUFDQWIsR0FBRyxDQUFDVyxHQUFHLENBQUNHLDBCQUFpQixDQUFDOztBQUUxQjtBQUNBZCxHQUFHLENBQUNXLEdBQUcsQ0FBQyxrQkFBa0IsRUFBRU4sWUFBWSxDQUFDVSxnQkFBZ0IsQ0FBQztBQUMxRGYsR0FBRyxDQUFDVyxHQUFHLENBQUMsa0JBQWtCLEVBQUVOLFlBQVksQ0FBQ1csWUFBWSxDQUFDO0FBQ3REaEIsR0FBRyxDQUFDVyxHQUFHLENBQUMsa0JBQWtCLEVBQUVOLFlBQVksQ0FBQ1ksWUFBWSxDQUFDO0FBQ3REakIsR0FBRyxDQUFDVyxHQUFHLENBQUNOLFlBQVksQ0FBQ2EsY0FBYyxDQUFDLENBQUMsQ0FBQzs7QUFFdEM7QUFDQWxCLEdBQUcsQ0FBQ1csR0FBRyxDQUFDLE9BQU8sRUFBRVEseUJBQVMsQ0FBQ0MsS0FBSyxFQUFFRCx5QkFBUyxDQUFDRSxLQUFLLENBQUMzQixlQUFlLENBQUMsQ0FBQzs7QUFFbkU7QUFDQU0sR0FBRyxDQUFDc0IsR0FBRyxDQUFDLFNBQVMsRUFBRSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUMvQkEsR0FBRyxDQUFDQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztJQUNuQkQsTUFBTSxFQUFFLElBQUk7SUFDWkUsT0FBTyxFQUFFLG1CQUFtQjtJQUM1QkMsU0FBUyxFQUFFLElBQUlDLElBQUksQ0FBQyxDQUFDLENBQUNDLFdBQVcsQ0FBQyxDQUFDO0lBQ25DQyxPQUFPLEVBQUU1QixPQUFPLENBQUNDLEdBQUcsQ0FBQzRCO0VBQ3ZCLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQzs7QUFFRjtBQUNBaEMsR0FBRyxDQUFDc0IsR0FBRyxDQUFDLFVBQVUsRUFBRVcsdUJBQWMsQ0FBQzs7QUFFbkM7QUFDQWpDLEdBQUcsQ0FBQ1csR0FBRyxDQUFDLFlBQVksRUFBRXVCLGtCQUFlLENBQUM7O0FBRXRDO0FBQ0FsQyxHQUFHLENBQUNXLEdBQUcsQ0FBQ3dCLG9CQUFZLENBQUM7O0FBRXJCO0FBQ0EsTUFBTUMsZ0JBQWdCLEdBQUcsTUFBQUEsQ0FBT0MsT0FBTyxHQUFHLENBQUMsRUFBRUMsUUFBUSxHQUFHLElBQUksS0FBSztFQUMvRCxLQUFLLElBQUlDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR0YsT0FBTyxFQUFFRSxDQUFDLEVBQUUsRUFBRTtJQUNoQyxJQUFJO01BQ0YsTUFBTUMsaUJBQVEsQ0FBQ0MsT0FBTyxDQUFDdEMsT0FBTyxDQUFDQyxHQUFHLENBQUNzQyxXQUFXLElBQUksK0NBQStDLEVBQUU7UUFDakdDLHdCQUF3QixFQUFFLElBQUk7UUFDOUJDLGVBQWUsRUFBRTtNQUNuQixDQUFDLENBQUM7TUFDRkMsT0FBTyxDQUFDQyxHQUFHLENBQUMsc0JBQXNCLENBQUM7TUFDbkM7SUFDRixDQUFDLENBQUMsT0FBT0MsR0FBRyxFQUFFO01BQ1pGLE9BQU8sQ0FBQ0csS0FBSyxDQUFDLDhCQUE4QlQsQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFUSxHQUFHLENBQUM7TUFDakUsSUFBSVIsQ0FBQyxLQUFLRixPQUFPLEdBQUcsQ0FBQyxFQUFFO1FBQ3JCUSxPQUFPLENBQUNHLEtBQUssQ0FBQyxpQ0FBaUMsQ0FBQztRQUNoRDdDLE9BQU8sQ0FBQzhDLElBQUksQ0FBQyxDQUFDLENBQUM7TUFDakI7TUFDQSxNQUFNLElBQUFDLFFBQUEsQ0FBQUMsT0FBQSxDQUFZLENBQUFDLE9BQU8sS0FBSSxJQUFBQyxZQUFBLENBQUFGLE9BQUEsRUFBV0MsT0FBTyxFQUFFZCxRQUFRLENBQUMsQ0FBQztJQUM3RDtFQUNGO0FBQ0YsQ0FBQzs7QUFFRDtBQUNBLE1BQU1nQixnQkFBZ0IsR0FBRyxNQUFBQSxDQUFBLEtBQVk7RUFDbkNULE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDBCQUEwQixDQUFDOztFQUV2QztFQUNBLElBQUk7SUFDRixNQUFNTixpQkFBUSxDQUFDZSxVQUFVLENBQUNDLEtBQUssQ0FBQyxDQUFDO0lBQ2pDWCxPQUFPLENBQUNDLEdBQUcsQ0FBQywyQkFBMkIsQ0FBQztFQUMxQyxDQUFDLENBQUMsT0FBT0MsR0FBRyxFQUFFO0lBQ1pGLE9BQU8sQ0FBQ0csS0FBSyxDQUFDLG1DQUFtQyxFQUFFRCxHQUFHLENBQUM7RUFDekQ7O0VBRUE7RUFDQSxJQUFJLEtBQUFVLFFBQUEsRUFBQUMsU0FBQTtJQUNGLE1BQU1DLFlBQVksR0FBRztJQUNuQixHQUFHLElBQUFDLElBQUEsQ0FBQVQsT0FBQSxFQUFBTSxRQUFBLE9BQUFJLE9BQUEsQ0FBQVYsT0FBQSxFQUFjM0MsTUFBTSxDQUFDLEVBQUFzRCxJQUFBLENBQUFMLFFBQUEsRUFBSyxDQUFBTSxLQUFLLEtBQUlBLEtBQUssQ0FBQ0MsS0FBSyxDQUFDO0lBQ2xELEdBQUcsSUFBQUosSUFBQSxDQUFBVCxPQUFBLEVBQUFPLFNBQUEsT0FBQUcsT0FBQSxDQUFBVixPQUFBLEVBQWM5QyxZQUFZLENBQUMsRUFBQXlELElBQUEsQ0FBQUosU0FBQSxFQUFLLENBQUFPLE9BQU8sS0FBSUEsT0FBTyxDQUFDRCxLQUFLLENBQUMsQ0FDN0Q7O0lBQ0QsTUFBTWQsUUFBQSxDQUFBQyxPQUFBLENBQVFlLEdBQUcsQ0FBQyxJQUFBTixJQUFBLENBQUFULE9BQUEsRUFBQVEsWUFBWSxFQUFBRyxJQUFBLENBQVpILFlBQVksRUFBSyxDQUFBUSxNQUFNLEtBQUlBLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzVEdkIsT0FBTyxDQUFDQyxHQUFHLENBQUMsMEJBQTBCLENBQUM7RUFDekMsQ0FBQyxDQUFDLE9BQU9DLEdBQUcsRUFBRTtJQUNaRixPQUFPLENBQUNHLEtBQUssQ0FBQyxrQ0FBa0MsRUFBRUQsR0FBRyxDQUFDO0VBQ3hEOztFQUVBO0VBQ0E1QyxPQUFPLENBQUM4QyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ2pCLENBQUM7O0FBRUQ7QUFDQTlDLE9BQU8sQ0FBQ2tFLEVBQUUsQ0FBQyxTQUFTLEVBQUVmLGdCQUFnQixDQUFDO0FBQ3ZDbkQsT0FBTyxDQUFDa0UsRUFBRSxDQUFDLFFBQVEsRUFBRWYsZ0JBQWdCLENBQUM7O0FBRXRDO0FBQ0EsSUFBSW5ELE9BQU8sQ0FBQ0MsR0FBRyxDQUFDa0UsUUFBUSxLQUFLLE1BQU0sRUFBRTtFQUNuQ2xDLGdCQUFnQixDQUFDLENBQUMsQ0FBQ21DLElBQUksQ0FBQyxNQUFNO0lBQzVCdkUsR0FBRyxDQUFDd0UsTUFBTSxDQUFDdEUsSUFBSSxFQUFFLE1BQU07TUFDckIyQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxxQ0FBcUM1QyxJQUFJLEVBQUUsQ0FBQztNQUN4RDJDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLCtDQUErQzVDLElBQUksT0FBTyxDQUFDO01BQ3ZFMkMsT0FBTyxDQUFDQyxHQUFHLENBQUMsOENBQThDNUMsSUFBSSxTQUFTLENBQUM7TUFDeEUyQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyx5Q0FBeUM1QyxJQUFJLFVBQVUsQ0FBQztJQUN0RSxDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDLElBQUF1RSxRQUFBLEdBQUFDLE9BQUEsQ0FBQXZCLE9BQUE7O0FBRWNuRCxHQUFHIiwiaWdub3JlTGlzdCI6W119
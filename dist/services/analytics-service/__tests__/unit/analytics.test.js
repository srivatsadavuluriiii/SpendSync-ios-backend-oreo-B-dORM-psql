"use strict";var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault");var _forEach = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/for-each"));var _entries = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/entries"));var _map = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/map"));var _sort = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/sort"));var _filter = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/filter"));var _slice = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/slice"));var _reduce = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/reduce"));var _mlRegressionSimpleLinear = require("ml-regression-simple-linear");
var _setup = require("../setup.js");
var _AnalyticsEvent = _interopRequireDefault(require("../../src/models/AnalyticsEvent.js"));
var _SpendingReport = _interopRequireDefault(require("../../src/models/SpendingReport.js"));

describe('Analytics Algorithms Unit Tests', () => {
  describe('Spending Pattern Analysis', () => {
    const testData = (0, _setup.generateTestExpenses)(100);

    test('should calculate correct spending by category', () => {var _context;
      const categoryTotals = {};
      (0, _forEach.default)(testData).call(testData, (expense) => {
        categoryTotals[expense.category] = (categoryTotals[expense.category] || 0) + expense.amount;
      });

      (0, _forEach.default)(_context = (0, _entries.default)(categoryTotals)).call(_context, ([category, total]) => {
        expect(total).toBeGreaterThan(0);
        expect(typeof total).toBe('number');
      });
    });

    test('should identify top spending categories', () => {var _context2, _context3;
      const categoryTotals = {};
      (0, _forEach.default)(testData).call(testData, (expense) => {
        categoryTotals[expense.category] = (categoryTotals[expense.category] || 0) + expense.amount;
      });

      const sortedCategories = (0, _map.default)(_context2 = (0, _sort.default)(_context3 = (0, _entries.default)(categoryTotals)).call(_context3,
      ([, a], [, b]) => b - a)).call(_context2,
      ([category]) => category);

      expect(sortedCategories.length).toBeGreaterThan(0);
      expect(sortedCategories[0]).toBeDefined();
    });
  });

  describe('Trend Analysis', () => {
    test('should calculate month-over-month changes correctly', () => {
      const monthlyData = [1000, 1200, 900, 1500];
      const momChanges = (0, _map.default)(monthlyData).call(monthlyData, (amount, i) => {
        if (i === 0) return 0;
        return (amount - monthlyData[i - 1]) / monthlyData[i - 1] * 100;
      });

      expect(momChanges[1]).toBe(20); // (1200 - 1000) / 1000 * 100
      expect(momChanges[2]).toBe(-25); // (900 - 1200) / 1200 * 100
      expect(momChanges[3]).toBe(66.67); // (1500 - 900) / 900 * 100
    });

    test('should detect significant spending changes', () => {
      const monthlyData = [1000, 2000, 1800, 3000];
      const significantChangeThreshold = 50;

      const changes = (0, _map.default)(monthlyData).call(monthlyData, (amount, i) => {
        if (i === 0) return 0;
        return (amount - monthlyData[i - 1]) / monthlyData[i - 1] * 100;
      });

      const significantChanges = (0, _filter.default)(changes).call(changes, (change) => Math.abs(change) > significantChangeThreshold);
      expect(significantChanges.length).toBeGreaterThan(0);
    });
  });

  describe('Prediction Algorithms', () => {
    test('should predict future spending using linear regression', () => {
      const monthlyData = [1000, 1100, 1250, 1400];
      const months = [0, 1, 2, 3];

      const regression = new _mlRegressionSimpleLinear.SimpleLinearRegression(months, monthlyData);
      const prediction = regression.predict(4);

      expect(prediction).toBeGreaterThan(monthlyData[monthlyData.length - 1]);
      expect(typeof prediction).toBe('number');
    });

    test('should calculate prediction confidence score', () => {
      const monthlyData = [1000, 1100, 1250, 1400];
      const months = [0, 1, 2, 3];

      const regression = new _mlRegressionSimpleLinear.SimpleLinearRegression(months, monthlyData);
      const r2Score = regression.score(months, monthlyData);

      expect(r2Score).toBeGreaterThanOrEqual(0);
      expect(r2Score).toBeLessThanOrEqual(1);
    });
  });

  describe('Budget Analysis', () => {
    test('should calculate budget variance correctly', () => {
      const budget = 1000;
      const actualSpending = 1200;
      const variance = (actualSpending - budget) / budget * 100;

      expect(variance).toBe(20);
    });

    test('should identify over-budget categories', () => {var _context4, _context5;
      const budgets = {
        food: 500,
        transport: 300,
        entertainment: 200
      };

      const spending = {
        food: 600,
        transport: 250,
        entertainment: 300
      };

      const overBudgetCategories = (0, _map.default)(_context4 = (0, _filter.default)(_context5 = (0, _entries.default)(spending)).call(_context5,
      ([category, amount]) => amount > budgets[category])).call(_context4,
      ([category]) => category);

      expect(overBudgetCategories).toContain('food');
      expect(overBudgetCategories).toContain('entertainment');
      expect(overBudgetCategories).not.toContain('transport');
    });
  });

  describe('Data Aggregation', () => {
    test('should aggregate daily spending correctly', () => {
      const expenses = [
      { amount: 100, timestamp: new Date('2024-01-01') },
      { amount: 200, timestamp: new Date('2024-01-01') },
      { amount: 150, timestamp: new Date('2024-01-02') }];


      const dailyTotals = {};
      (0, _forEach.default)(expenses).call(expenses, (expense) => {
        const date = expense.timestamp.toISOString().split('T')[0];
        dailyTotals[date] = (dailyTotals[date] || 0) + expense.amount;
      });

      expect(dailyTotals['2024-01-01']).toBe(300);
      expect(dailyTotals['2024-01-02']).toBe(150);
    });

    test('should calculate moving averages', () => {
      const dailySpending = [100, 200, 150, 300, 250];
      const windowSize = 3;
      const movingAverages = [];

      for (let i = 0; i <= dailySpending.length - windowSize; i++) {
        const window = (0, _slice.default)(dailySpending).call(dailySpending, i, i + windowSize);
        const average = (0, _reduce.default)(window).call(window, (a, b) => a + b, 0) / windowSize;
        movingAverages.push(average);
      }

      expect(movingAverages[0]).toBe(150); // (100 + 200 + 150) / 3
      expect(movingAverages[1]).toBe(216.67); // (200 + 150 + 300) / 3
      expect(movingAverages[2]).toBe(233.33); // (150 + 300 + 250) / 3
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbWxSZWdyZXNzaW9uU2ltcGxlTGluZWFyIiwicmVxdWlyZSIsIl9zZXR1cCIsIl9BbmFseXRpY3NFdmVudCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfU3BlbmRpbmdSZXBvcnQiLCJkZXNjcmliZSIsInRlc3REYXRhIiwiZ2VuZXJhdGVUZXN0RXhwZW5zZXMiLCJ0ZXN0IiwiX2NvbnRleHQiLCJjYXRlZ29yeVRvdGFscyIsIl9mb3JFYWNoIiwiZGVmYXVsdCIsImNhbGwiLCJleHBlbnNlIiwiY2F0ZWdvcnkiLCJhbW91bnQiLCJfZW50cmllcyIsInRvdGFsIiwiZXhwZWN0IiwidG9CZUdyZWF0ZXJUaGFuIiwidG9CZSIsIl9jb250ZXh0MiIsIl9jb250ZXh0MyIsInNvcnRlZENhdGVnb3JpZXMiLCJfbWFwIiwiX3NvcnQiLCJhIiwiYiIsImxlbmd0aCIsInRvQmVEZWZpbmVkIiwibW9udGhseURhdGEiLCJtb21DaGFuZ2VzIiwiaSIsInNpZ25pZmljYW50Q2hhbmdlVGhyZXNob2xkIiwiY2hhbmdlcyIsInNpZ25pZmljYW50Q2hhbmdlcyIsIl9maWx0ZXIiLCJjaGFuZ2UiLCJNYXRoIiwiYWJzIiwibW9udGhzIiwicmVncmVzc2lvbiIsIlNpbXBsZUxpbmVhclJlZ3Jlc3Npb24iLCJwcmVkaWN0aW9uIiwicHJlZGljdCIsInIyU2NvcmUiLCJzY29yZSIsInRvQmVHcmVhdGVyVGhhbk9yRXF1YWwiLCJ0b0JlTGVzc1RoYW5PckVxdWFsIiwiYnVkZ2V0IiwiYWN0dWFsU3BlbmRpbmciLCJ2YXJpYW5jZSIsIl9jb250ZXh0NCIsIl9jb250ZXh0NSIsImJ1ZGdldHMiLCJmb29kIiwidHJhbnNwb3J0IiwiZW50ZXJ0YWlubWVudCIsInNwZW5kaW5nIiwib3ZlckJ1ZGdldENhdGVnb3JpZXMiLCJ0b0NvbnRhaW4iLCJub3QiLCJleHBlbnNlcyIsInRpbWVzdGFtcCIsIkRhdGUiLCJkYWlseVRvdGFscyIsImRhdGUiLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwiZGFpbHlTcGVuZGluZyIsIndpbmRvd1NpemUiLCJtb3ZpbmdBdmVyYWdlcyIsIndpbmRvdyIsIl9zbGljZSIsImF2ZXJhZ2UiLCJfcmVkdWNlIiwicHVzaCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9zZXJ2aWNlcy9hbmFseXRpY3Mtc2VydmljZS9fX3Rlc3RzX18vdW5pdC9hbmFseXRpY3MudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaW1wbGVMaW5lYXJSZWdyZXNzaW9uIH0gZnJvbSAnbWwtcmVncmVzc2lvbi1zaW1wbGUtbGluZWFyJztcbmltcG9ydCB7IGdlbmVyYXRlVGVzdEV4cGVuc2VzIH0gZnJvbSAnLi4vc2V0dXAuanMnO1xuaW1wb3J0IEFuYWx5dGljc0V2ZW50IGZyb20gJy4uLy4uL3NyYy9tb2RlbHMvQW5hbHl0aWNzRXZlbnQuanMnO1xuaW1wb3J0IFNwZW5kaW5nUmVwb3J0IGZyb20gJy4uLy4uL3NyYy9tb2RlbHMvU3BlbmRpbmdSZXBvcnQuanMnO1xuXG5kZXNjcmliZSgnQW5hbHl0aWNzIEFsZ29yaXRobXMgVW5pdCBUZXN0cycsICgpID0+IHtcbiAgZGVzY3JpYmUoJ1NwZW5kaW5nIFBhdHRlcm4gQW5hbHlzaXMnLCAoKSA9PiB7XG4gICAgY29uc3QgdGVzdERhdGEgPSBnZW5lcmF0ZVRlc3RFeHBlbnNlcygxMDApO1xuXG4gICAgdGVzdCgnc2hvdWxkIGNhbGN1bGF0ZSBjb3JyZWN0IHNwZW5kaW5nIGJ5IGNhdGVnb3J5JywgKCkgPT4ge1xuICAgICAgY29uc3QgY2F0ZWdvcnlUb3RhbHMgPSB7fTtcbiAgICAgIHRlc3REYXRhLmZvckVhY2goZXhwZW5zZSA9PiB7XG4gICAgICAgIGNhdGVnb3J5VG90YWxzW2V4cGVuc2UuY2F0ZWdvcnldID0gKGNhdGVnb3J5VG90YWxzW2V4cGVuc2UuY2F0ZWdvcnldIHx8IDApICsgZXhwZW5zZS5hbW91bnQ7XG4gICAgICB9KTtcblxuICAgICAgT2JqZWN0LmVudHJpZXMoY2F0ZWdvcnlUb3RhbHMpLmZvckVhY2goKFtjYXRlZ29yeSwgdG90YWxdKSA9PiB7XG4gICAgICAgIGV4cGVjdCh0b3RhbCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICBleHBlY3QodHlwZW9mIHRvdGFsKS50b0JlKCdudW1iZXInKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGlkZW50aWZ5IHRvcCBzcGVuZGluZyBjYXRlZ29yaWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2F0ZWdvcnlUb3RhbHMgPSB7fTtcbiAgICAgIHRlc3REYXRhLmZvckVhY2goZXhwZW5zZSA9PiB7XG4gICAgICAgIGNhdGVnb3J5VG90YWxzW2V4cGVuc2UuY2F0ZWdvcnldID0gKGNhdGVnb3J5VG90YWxzW2V4cGVuc2UuY2F0ZWdvcnldIHx8IDApICsgZXhwZW5zZS5hbW91bnQ7XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgc29ydGVkQ2F0ZWdvcmllcyA9IE9iamVjdC5lbnRyaWVzKGNhdGVnb3J5VG90YWxzKVxuICAgICAgICAuc29ydCgoWywgYV0sIFssIGJdKSA9PiBiIC0gYSlcbiAgICAgICAgLm1hcCgoW2NhdGVnb3J5XSkgPT4gY2F0ZWdvcnkpO1xuXG4gICAgICBleHBlY3Qoc29ydGVkQ2F0ZWdvcmllcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChzb3J0ZWRDYXRlZ29yaWVzWzBdKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVHJlbmQgQW5hbHlzaXMnLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGNhbGN1bGF0ZSBtb250aC1vdmVyLW1vbnRoIGNoYW5nZXMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgbW9udGhseURhdGEgPSBbMTAwMCwgMTIwMCwgOTAwLCAxNTAwXTtcbiAgICAgIGNvbnN0IG1vbUNoYW5nZXMgPSBtb250aGx5RGF0YS5tYXAoKGFtb3VudCwgaSkgPT4ge1xuICAgICAgICBpZiAoaSA9PT0gMCkgcmV0dXJuIDA7XG4gICAgICAgIHJldHVybiAoKGFtb3VudCAtIG1vbnRobHlEYXRhW2kgLSAxXSkgLyBtb250aGx5RGF0YVtpIC0gMV0pICogMTAwO1xuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChtb21DaGFuZ2VzWzFdKS50b0JlKDIwKTsgLy8gKDEyMDAgLSAxMDAwKSAvIDEwMDAgKiAxMDBcbiAgICAgIGV4cGVjdChtb21DaGFuZ2VzWzJdKS50b0JlKC0yNSk7IC8vICg5MDAgLSAxMjAwKSAvIDEyMDAgKiAxMDBcbiAgICAgIGV4cGVjdChtb21DaGFuZ2VzWzNdKS50b0JlKDY2LjY3KTsgLy8gKDE1MDAgLSA5MDApIC8gOTAwICogMTAwXG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgZGV0ZWN0IHNpZ25pZmljYW50IHNwZW5kaW5nIGNoYW5nZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb250aGx5RGF0YSA9IFsxMDAwLCAyMDAwLCAxODAwLCAzMDAwXTtcbiAgICAgIGNvbnN0IHNpZ25pZmljYW50Q2hhbmdlVGhyZXNob2xkID0gNTA7XG5cbiAgICAgIGNvbnN0IGNoYW5nZXMgPSBtb250aGx5RGF0YS5tYXAoKGFtb3VudCwgaSkgPT4ge1xuICAgICAgICBpZiAoaSA9PT0gMCkgcmV0dXJuIDA7XG4gICAgICAgIHJldHVybiAoKGFtb3VudCAtIG1vbnRobHlEYXRhW2kgLSAxXSkgLyBtb250aGx5RGF0YVtpIC0gMV0pICogMTAwO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHNpZ25pZmljYW50Q2hhbmdlcyA9IGNoYW5nZXMuZmlsdGVyKGNoYW5nZSA9PiBNYXRoLmFicyhjaGFuZ2UpID4gc2lnbmlmaWNhbnRDaGFuZ2VUaHJlc2hvbGQpO1xuICAgICAgZXhwZWN0KHNpZ25pZmljYW50Q2hhbmdlcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1ByZWRpY3Rpb24gQWxnb3JpdGhtcycsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgcHJlZGljdCBmdXR1cmUgc3BlbmRpbmcgdXNpbmcgbGluZWFyIHJlZ3Jlc3Npb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb250aGx5RGF0YSA9IFsxMDAwLCAxMTAwLCAxMjUwLCAxNDAwXTtcbiAgICAgIGNvbnN0IG1vbnRocyA9IFswLCAxLCAyLCAzXTtcblxuICAgICAgY29uc3QgcmVncmVzc2lvbiA9IG5ldyBTaW1wbGVMaW5lYXJSZWdyZXNzaW9uKG1vbnRocywgbW9udGhseURhdGEpO1xuICAgICAgY29uc3QgcHJlZGljdGlvbiA9IHJlZ3Jlc3Npb24ucHJlZGljdCg0KTtcblxuICAgICAgZXhwZWN0KHByZWRpY3Rpb24pLnRvQmVHcmVhdGVyVGhhbihtb250aGx5RGF0YVttb250aGx5RGF0YS5sZW5ndGggLSAxXSk7XG4gICAgICBleHBlY3QodHlwZW9mIHByZWRpY3Rpb24pLnRvQmUoJ251bWJlcicpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGNhbGN1bGF0ZSBwcmVkaWN0aW9uIGNvbmZpZGVuY2Ugc2NvcmUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb250aGx5RGF0YSA9IFsxMDAwLCAxMTAwLCAxMjUwLCAxNDAwXTtcbiAgICAgIGNvbnN0IG1vbnRocyA9IFswLCAxLCAyLCAzXTtcblxuICAgICAgY29uc3QgcmVncmVzc2lvbiA9IG5ldyBTaW1wbGVMaW5lYXJSZWdyZXNzaW9uKG1vbnRocywgbW9udGhseURhdGEpO1xuICAgICAgY29uc3QgcjJTY29yZSA9IHJlZ3Jlc3Npb24uc2NvcmUobW9udGhzLCBtb250aGx5RGF0YSk7XG5cbiAgICAgIGV4cGVjdChyMlNjb3JlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgZXhwZWN0KHIyU2NvcmUpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdCdWRnZXQgQW5hbHlzaXMnLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGNhbGN1bGF0ZSBidWRnZXQgdmFyaWFuY2UgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgYnVkZ2V0ID0gMTAwMDtcbiAgICAgIGNvbnN0IGFjdHVhbFNwZW5kaW5nID0gMTIwMDtcbiAgICAgIGNvbnN0IHZhcmlhbmNlID0gKChhY3R1YWxTcGVuZGluZyAtIGJ1ZGdldCkgLyBidWRnZXQpICogMTAwO1xuXG4gICAgICBleHBlY3QodmFyaWFuY2UpLnRvQmUoMjApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGlkZW50aWZ5IG92ZXItYnVkZ2V0IGNhdGVnb3JpZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBidWRnZXRzID0ge1xuICAgICAgICBmb29kOiA1MDAsXG4gICAgICAgIHRyYW5zcG9ydDogMzAwLFxuICAgICAgICBlbnRlcnRhaW5tZW50OiAyMDBcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHNwZW5kaW5nID0ge1xuICAgICAgICBmb29kOiA2MDAsXG4gICAgICAgIHRyYW5zcG9ydDogMjUwLFxuICAgICAgICBlbnRlcnRhaW5tZW50OiAzMDBcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG92ZXJCdWRnZXRDYXRlZ29yaWVzID0gT2JqZWN0LmVudHJpZXMoc3BlbmRpbmcpXG4gICAgICAgIC5maWx0ZXIoKFtjYXRlZ29yeSwgYW1vdW50XSkgPT4gYW1vdW50ID4gYnVkZ2V0c1tjYXRlZ29yeV0pXG4gICAgICAgIC5tYXAoKFtjYXRlZ29yeV0pID0+IGNhdGVnb3J5KTtcblxuICAgICAgZXhwZWN0KG92ZXJCdWRnZXRDYXRlZ29yaWVzKS50b0NvbnRhaW4oJ2Zvb2QnKTtcbiAgICAgIGV4cGVjdChvdmVyQnVkZ2V0Q2F0ZWdvcmllcykudG9Db250YWluKCdlbnRlcnRhaW5tZW50Jyk7XG4gICAgICBleHBlY3Qob3ZlckJ1ZGdldENhdGVnb3JpZXMpLm5vdC50b0NvbnRhaW4oJ3RyYW5zcG9ydCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRGF0YSBBZ2dyZWdhdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgYWdncmVnYXRlIGRhaWx5IHNwZW5kaW5nIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGV4cGVuc2VzID0gW1xuICAgICAgICB7IGFtb3VudDogMTAwLCB0aW1lc3RhbXA6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJykgfSxcbiAgICAgICAgeyBhbW91bnQ6IDIwMCwgdGltZXN0YW1wOiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpIH0sXG4gICAgICAgIHsgYW1vdW50OiAxNTAsIHRpbWVzdGFtcDogbmV3IERhdGUoJzIwMjQtMDEtMDInKSB9XG4gICAgICBdO1xuXG4gICAgICBjb25zdCBkYWlseVRvdGFscyA9IHt9O1xuICAgICAgZXhwZW5zZXMuZm9yRWFjaChleHBlbnNlID0+IHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IGV4cGVuc2UudGltZXN0YW1wLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgICAgICAgZGFpbHlUb3RhbHNbZGF0ZV0gPSAoZGFpbHlUb3RhbHNbZGF0ZV0gfHwgMCkgKyBleHBlbnNlLmFtb3VudDtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoZGFpbHlUb3RhbHNbJzIwMjQtMDEtMDEnXSkudG9CZSgzMDApO1xuICAgICAgZXhwZWN0KGRhaWx5VG90YWxzWycyMDI0LTAxLTAyJ10pLnRvQmUoMTUwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBjYWxjdWxhdGUgbW92aW5nIGF2ZXJhZ2VzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZGFpbHlTcGVuZGluZyA9IFsxMDAsIDIwMCwgMTUwLCAzMDAsIDI1MF07XG4gICAgICBjb25zdCB3aW5kb3dTaXplID0gMztcbiAgICAgIGNvbnN0IG1vdmluZ0F2ZXJhZ2VzID0gW107XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IGRhaWx5U3BlbmRpbmcubGVuZ3RoIC0gd2luZG93U2l6ZTsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHdpbmRvdyA9IGRhaWx5U3BlbmRpbmcuc2xpY2UoaSwgaSArIHdpbmRvd1NpemUpO1xuICAgICAgICBjb25zdCBhdmVyYWdlID0gd2luZG93LnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApIC8gd2luZG93U2l6ZTtcbiAgICAgICAgbW92aW5nQXZlcmFnZXMucHVzaChhdmVyYWdlKTtcbiAgICAgIH1cblxuICAgICAgZXhwZWN0KG1vdmluZ0F2ZXJhZ2VzWzBdKS50b0JlKDE1MCk7IC8vICgxMDAgKyAyMDAgKyAxNTApIC8gM1xuICAgICAgZXhwZWN0KG1vdmluZ0F2ZXJhZ2VzWzFdKS50b0JlKDIxNi42Nyk7IC8vICgyMDAgKyAxNTAgKyAzMDApIC8gM1xuICAgICAgZXhwZWN0KG1vdmluZ0F2ZXJhZ2VzWzJdKS50b0JlKDIzMy4zMyk7IC8vICgxNTAgKyAzMDAgKyAyNTApIC8gM1xuICAgIH0pO1xuICB9KTtcbn0pOyAiXSwibWFwcGluZ3MiOiJrekJBQUEsSUFBQUEseUJBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLE1BQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLGVBQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLGVBQUEsR0FBQUQsc0JBQUEsQ0FBQUgsT0FBQTs7QUFFQUssUUFBUSxDQUFDLGlDQUFpQyxFQUFFLE1BQU07RUFDaERBLFFBQVEsQ0FBQywyQkFBMkIsRUFBRSxNQUFNO0lBQzFDLE1BQU1DLFFBQVEsR0FBRyxJQUFBQywyQkFBb0IsRUFBQyxHQUFHLENBQUM7O0lBRTFDQyxJQUFJLENBQUMsK0NBQStDLEVBQUUsTUFBTSxLQUFBQyxRQUFBO01BQzFELE1BQU1DLGNBQWMsR0FBRyxDQUFDLENBQUM7TUFDekIsSUFBQUMsUUFBQSxDQUFBQyxPQUFBLEVBQUFOLFFBQVEsRUFBQU8sSUFBQSxDQUFSUCxRQUFRLEVBQVMsQ0FBQVEsT0FBTyxLQUFJO1FBQzFCSixjQUFjLENBQUNJLE9BQU8sQ0FBQ0MsUUFBUSxDQUFDLEdBQUcsQ0FBQ0wsY0FBYyxDQUFDSSxP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
"use strict";var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault");var _isArray = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/array/is-array"));var _supertest = _interopRequireDefault(require("supertest"));
var _mongoose = _interopRequireDefault(require("mongoose"));
var _index = _interopRequireDefault(require("../src/index.js"));
var _AnalyticsEvent = _interopRequireDefault(require("../src/models/AnalyticsEvent.js"));

describe('Predictions Endpoints', () => {
  beforeEach(async () => {
    await _AnalyticsEvent.default.deleteMany({});
  });

  describe('GET /predictions', () => {
    it('should return 401 without user ID', async () => {
      const response = await (0, _supertest.default)(_index.default).
      get('/predictions').
      expect(401);

      expect(response.body.error).toBe('User ID is required');
    });

    it('should return predictions with confidence intervals', async () => {
      const userId = new _mongoose.default.Types.ObjectId();
      const transactions = [
      { amount: 100, category: 'groceries', timestamp: new Date() },
      { amount: 150, category: 'groceries', timestamp: new Date() },
      { amount: 200, category: 'groceries', timestamp: new Date() }];


      for (const t of transactions) {
        await new _AnalyticsEvent.default({
          userId,
          eventType: 'EXPENSE_CREATED',
          ...t
        }).save();
      }

      const response = await (0, _supertest.default)(_index.default).
      get('/predictions').
      query({ userId: userId.toString() }).
      expect(200);

      expect(response.body).toHaveProperty('predictions');
      expect(response.body.predictions).toHaveProperty('amount');
      expect(response.body.predictions).toHaveProperty('confidenceInterval');
    });

    it('should respect the months parameter', async () => {
      const userId = new _mongoose.default.Types.ObjectId();
      const transactions = [
      { amount: 100, category: 'groceries', timestamp: new Date() },
      { amount: 150, category: 'groceries', timestamp: new Date() }];


      for (const t of transactions) {
        await new _AnalyticsEvent.default({
          userId,
          eventType: 'EXPENSE_CREATED',
          ...t
        }).save();
      }

      const response = await (0, _supertest.default)(_index.default).
      get('/predictions').
      query({
        userId: userId.toString(),
        months: 3
      }).
      expect(200);

      expect(response.body.predictions).toHaveProperty('amount');
      expect(response.body.predictions).toHaveProperty('confidenceInterval');
    });
  });

  describe('GET /predictions/by-category', () => {
    it('should return category-specific predictions', async () => {
      const userId = new _mongoose.default.Types.ObjectId();
      const transactions = [
      { amount: 100, category: 'groceries', timestamp: new Date() },
      { amount: 150, category: 'groceries', timestamp: new Date() }];


      for (const t of transactions) {
        await new _AnalyticsEvent.default({
          userId,
          eventType: 'EXPENSE_CREATED',
          ...t
        }).save();
      }

      const response = await (0, _supertest.default)(_index.default).
      get('/predictions/by-category').
      query({ userId: userId.toString() }).
      expect(200);

      expect(response.body).toHaveProperty('categories');
      expect(response.body.categories).toHaveProperty('groceries');
      expect(response.body.categories.groceries).toHaveProperty('prediction');
    });

    it('should filter by specific category', async () => {
      const userId = new _mongoose.default.Types.ObjectId();
      const transactions = [
      { amount: 100, category: 'groceries', timestamp: new Date() },
      { amount: 150, category: 'groceries', timestamp: new Date() }];


      for (const t of transactions) {
        await new _AnalyticsEvent.default({
          userId,
          eventType: 'EXPENSE_CREATED',
          ...t
        }).save();
      }

      const response = await (0, _supertest.default)(_index.default).
      get('/predictions/by-category').
      query({
        userId: userId.toString(),
        category: 'groceries'
      }).
      expect(200);

      expect(response.body).toHaveProperty('categories');
      expect(response.body.categories).toHaveProperty('groceries');
      expect(response.body.categories.groceries).toHaveProperty('prediction');
    });
  });

  describe('GET /predictions/seasonal', () => {
    it('should identify seasonal patterns', async () => {
      const userId = new _mongoose.default.Types.ObjectId();
      const transactions = [
      { amount: 100, category: 'groceries', timestamp: new Date() },
      { amount: 150, category: 'groceries', timestamp: new Date() }];


      for (const t of transactions) {
        await new _AnalyticsEvent.default({
          userId,
          eventType: 'EXPENSE_CREATED',
          ...t
        }).save();
      }

      const response = await (0, _supertest.default)(_index.default).
      get('/predictions/seasonal').
      query({ userId: userId.toString() }).
      expect(200);

      expect(response.body).toHaveProperty('patterns');
      expect((0, _isArray.default)(response.body.patterns)).toBe(true);
    });

    it('should handle empty data gracefully', async () => {
      const userId = new _mongoose.default.Types.ObjectId();
      const response = await (0, _supertest.default)(_index.default).
      get('/predictions/seasonal').
      query({ userId: userId.toString() }).
      expect(200);

      expect(response.body.patterns).toEqual([]);
    });
  });

  describe('Input Validation', () => {
    it('should validate months parameter', async () => {
      const userId = new _mongoose.default.Types.ObjectId();
      const response = await (0, _supertest.default)(_index.default).
      get('/predictions').
      query({
        userId: userId.toString(),
        months: 'invalid'
      }).
      expect(400);

      expect(response.body.error).toBe('Invalid months parameter');
    });

    it('should limit months to 12', async () => {
      const userId = new _mongoose.default.Types.ObjectId();
      const response = await (0, _supertest.default)(_index.default).
      get('/predictions').
      query({
        userId: userId.toString(),
        months: 13
      }).
      expect(400);

      expect(response.body.error).toBe('Months parameter must be between 1 and 12');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfc3VwZXJ0ZXN0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfbW9uZ29vc2UiLCJfaW5kZXgiLCJfQW5hbHl0aWNzRXZlbnQiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJBbmFseXRpY3NFdmVudCIsImRlbGV0ZU1hbnkiLCJpdCIsInJlc3BvbnNlIiwicmVxdWVzdCIsImFwcCIsImdldCIsImV4cGVjdCIsImJvZHkiLCJlcnJvciIsInRvQmUiLCJ1c2VySWQiLCJtb25nb29zZSIsIlR5cGVzIiwiT2JqZWN0SWQiLCJ0cmFuc2FjdGlvbnMiLCJhbW91bnQiLCJjYXRlZ29yeSIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0IiwiZXZlbnRUeXBlIiwic2F2ZSIsInF1ZXJ5IiwidG9TdHJpbmciLCJ0b0hhdmVQcm9wZXJ0eSIsInByZWRpY3Rpb25zIiwibW9udGhzIiwiY2F0ZWdvcmllcyIsImdyb2NlcmllcyIsIl9pc0FycmF5IiwiZGVmYXVsdCIsInBhdHRlcm5zIiwidG9FcXVhbCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9zZXJ2aWNlcy9hbmFseXRpY3Mtc2VydmljZS9fX3Rlc3RzX18vcHJlZGljdGlvbnMudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcmVxdWVzdCBmcm9tICdzdXBlcnRlc3QnO1xuaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcbmltcG9ydCBhcHAgZnJvbSAnLi4vc3JjL2luZGV4LmpzJztcbmltcG9ydCBBbmFseXRpY3NFdmVudCBmcm9tICcuLi9zcmMvbW9kZWxzL0FuYWx5dGljc0V2ZW50LmpzJztcblxuZGVzY3JpYmUoJ1ByZWRpY3Rpb25zIEVuZHBvaW50cycsICgpID0+IHtcbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgQW5hbHl0aWNzRXZlbnQuZGVsZXRlTWFueSh7fSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL3ByZWRpY3Rpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSB3aXRob3V0IHVzZXIgSUQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvcHJlZGljdGlvbnMnKVxuICAgICAgICAuZXhwZWN0KDQwMSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmVycm9yKS50b0JlKCdVc2VyIElEIGlzIHJlcXVpcmVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBwcmVkaWN0aW9ucyB3aXRoIGNvbmZpZGVuY2UgaW50ZXJ2YWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlcklkID0gbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKCk7XG4gICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBbXG4gICAgICAgIHsgYW1vdW50OiAxMDAsIGNhdGVnb3J5OiAnZ3JvY2VyaWVzJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH0sXG4gICAgICAgIHsgYW1vdW50OiAxNTAsIGNhdGVnb3J5OiAnZ3JvY2VyaWVzJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH0sXG4gICAgICAgIHsgYW1vdW50OiAyMDAsIGNhdGVnb3J5OiAnZ3JvY2VyaWVzJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH1cbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgdCBvZiB0cmFuc2FjdGlvbnMpIHtcbiAgICAgICAgYXdhaXQgbmV3IEFuYWx5dGljc0V2ZW50KHtcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgZXZlbnRUeXBlOiAnRVhQRU5TRV9DUkVBVEVEJyxcbiAgICAgICAgICAuLi50XG4gICAgICAgIH0pLnNhdmUoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL3ByZWRpY3Rpb25zJylcbiAgICAgICAgLnF1ZXJ5KHsgdXNlcklkOiB1c2VySWQudG9TdHJpbmcoKSB9KVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgncHJlZGljdGlvbnMnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnByZWRpY3Rpb25zKS50b0hhdmVQcm9wZXJ0eSgnYW1vdW50Jyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5wcmVkaWN0aW9ucykudG9IYXZlUHJvcGVydHkoJ2NvbmZpZGVuY2VJbnRlcnZhbCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXNwZWN0IHRoZSBtb250aHMgcGFyYW1ldGVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlcklkID0gbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKCk7XG4gICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBbXG4gICAgICAgIHsgYW1vdW50OiAxMDAsIGNhdGVnb3J5OiAnZ3JvY2VyaWVzJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH0sXG4gICAgICAgIHsgYW1vdW50OiAxNTAsIGNhdGVnb3J5OiAnZ3JvY2VyaWVzJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH1cbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgdCBvZiB0cmFuc2FjdGlvbnMpIHtcbiAgICAgICAgYXdhaXQgbmV3IEFuYWx5dGljc0V2ZW50KHtcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgZXZlbnRUeXBlOiAnRVhQRU5TRV9DUkVBVEVEJyxcbiAgICAgICAgICAuLi50XG4gICAgICAgIH0pLnNhdmUoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL3ByZWRpY3Rpb25zJylcbiAgICAgICAgLnF1ZXJ5KHsgXG4gICAgICAgICAgdXNlcklkOiB1c2VySWQudG9TdHJpbmcoKSxcbiAgICAgICAgICBtb250aHM6IDNcbiAgICAgICAgfSlcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5wcmVkaWN0aW9ucykudG9IYXZlUHJvcGVydHkoJ2Ftb3VudCcpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkucHJlZGljdGlvbnMpLnRvSGF2ZVByb3BlcnR5KCdjb25maWRlbmNlSW50ZXJ2YWwnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvcHJlZGljdGlvbnMvYnktY2F0ZWdvcnknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY2F0ZWdvcnktc3BlY2lmaWMgcHJlZGljdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VySWQgPSBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQoKTtcbiAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IFtcbiAgICAgICAgeyBhbW91bnQ6IDEwMCwgY2F0ZWdvcnk6ICdncm9jZXJpZXMnLCB0aW1lc3RhbXA6IG5ldyBEYXRlKCkgfSxcbiAgICAgICAgeyBhbW91bnQ6IDE1MCwgY2F0ZWdvcnk6ICdncm9jZXJpZXMnLCB0aW1lc3RhbXA6IG5ldyBEYXRlKCkgfVxuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCB0IG9mIHRyYW5zYWN0aW9ucykge1xuICAgICAgICBhd2FpdCBuZXcgQW5hbHl0aWNzRXZlbnQoe1xuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICBldmVudFR5cGU6ICdFWFBFTlNFX0NSRUFURUQnLFxuICAgICAgICAgIC4uLnRcbiAgICAgICAgfSkuc2F2ZSgpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvcHJlZGljdGlvbnMvYnktY2F0ZWdvcnknKVxuICAgICAgICAucXVlcnkoeyB1c2VySWQ6IHVzZXJJZC50b1N0cmluZygpIH0pXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdjYXRlZ29yaWVzJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5jYXRlZ29yaWVzKS50b0hhdmVQcm9wZXJ0eSgnZ3JvY2VyaWVzJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5jYXRlZ29yaWVzLmdyb2NlcmllcykudG9IYXZlUHJvcGVydHkoJ3ByZWRpY3Rpb24nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmlsdGVyIGJ5IHNwZWNpZmljIGNhdGVnb3J5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlcklkID0gbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKCk7XG4gICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBbXG4gICAgICAgIHsgYW1vdW50OiAxMDAsIGNhdGVnb3J5OiAnZ3JvY2VyaWVzJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH0sXG4gICAgICAgIHsgYW1vdW50OiAxNTAsIGNhdGVnb3J5OiAnZ3JvY2VyaWVzJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH1cbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgdCBvZiB0cmFuc2FjdGlvbnMpIHtcbiAgICAgICAgYXdhaXQgbmV3IEFuYWx5dGljc0V2ZW50KHtcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgZXZlbnRUeXBlOiAnRVhQRU5TRV9DUkVBVEVEJyxcbiAgICAgICAgICAuLi50XG4gICAgICAgIH0pLnNhdmUoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL3ByZWRpY3Rpb25zL2J5LWNhdGVnb3J5JylcbiAgICAgICAgLnF1ZXJ5KHsgXG4gICAgICAgICAgdXNlcklkOiB1c2VySWQudG9TdHJpbmcoKSxcbiAgICAgICAgICBjYXRlZ29yeTogJ2dyb2NlcmllcydcbiAgICAgICAgfSlcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2NhdGVnb3JpZXMnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmNhdGVnb3JpZXMpLnRvSGF2ZVByb3BlcnR5KCdncm9jZXJpZXMnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmNhdGVnb3JpZXMuZ3JvY2VyaWVzKS50b0hhdmVQcm9wZXJ0eSgncHJlZGljdGlvbicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9wcmVkaWN0aW9ucy9zZWFzb25hbCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IHNlYXNvbmFsIHBhdHRlcm5zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlcklkID0gbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKCk7XG4gICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBbXG4gICAgICAgIHsgYW1vdW50OiAxMDAsIGNhdGVnb3J5OiAnZ3JvY2VyaWVzJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH0sXG4gICAgICAgIHsgYW1vdW50OiAxNTAsIGNhdGVnb3J5OiAnZ3JvY2VyaWVzJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH1cbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgdCBvZiB0cmFuc2FjdGlvbnMpIHtcbiAgICAgICAgYXdhaXQgbmV3IEFuYWx5dGljc0V2ZW50KHtcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgZXZlbnRUeXBlOiAnRVhQRU5TRV9DUkVBVEVEJyxcbiAgICAgICAgICAuLi50XG4gICAgICAgIH0pLnNhdmUoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL3ByZWRpY3Rpb25zL3NlYXNvbmFsJylcbiAgICAgICAgLnF1ZXJ5KHsgdXNlcklkOiB1c2VySWQudG9TdHJpbmcoKSB9KVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgncGF0dGVybnMnKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3BvbnNlLmJvZHkucGF0dGVybnMpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgZGF0YSBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlcklkID0gbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKCk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvcHJlZGljdGlvbnMvc2Vhc29uYWwnKVxuICAgICAgICAucXVlcnkoeyB1c2VySWQ6IHVzZXJJZC50b1N0cmluZygpIH0pXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkucGF0dGVybnMpLnRvRXF1YWwoW10pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW5wdXQgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIG1vbnRocyBwYXJhbWV0ZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VySWQgPSBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQoKTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9wcmVkaWN0aW9ucycpXG4gICAgICAgIC5xdWVyeSh7IFxuICAgICAgICAgIHVzZXJJZDogdXNlcklkLnRvU3RyaW5nKCksXG4gICAgICAgICAgbW9udGhzOiAnaW52YWxpZCdcbiAgICAgICAgfSlcbiAgICAgICAgLmV4cGVjdCg0MDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvcikudG9CZSgnSW52YWxpZCBtb250aHMgcGFyYW1ldGVyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGxpbWl0IG1vbnRocyB0byAxMicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVzZXJJZCA9IG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZCgpO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL3ByZWRpY3Rpb25zJylcbiAgICAgICAgLnF1ZXJ5KHsgXG4gICAgICAgICAgdXNlcklkOiB1c2VySWQudG9TdHJpbmcoKSxcbiAgICAgICAgICBtb250aHM6IDEzXG4gICAgICAgIH0pXG4gICAgICAgIC5leHBlY3QoNDAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQmUoJ01vbnRocyBwYXJhbWV0ZXIgbXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDEyJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7ICJdLCJtYXBwaW5ncyI6ImlOQUFBLElBQUFBLFVBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLE1BQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLGVBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTs7QUFFQUksUUFBUSxDQUFDLHVCQUF1QixFQUFFLE1BQU07RUFDdENDLFVBQVUsQ0FBQyxZQUFZO0lBQ3JCLE1BQU1DLHVCQUFjLENBQUNDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUNyQyxDQUFDLENBQUM7O0VBRUZILFFBQVEsQ0FBQyxrQkFBa0IsRUFBRSxNQUFNO0lBQ2pDSSxFQUFFLENBQUMsbUNBQW1DLEVBQUUsWUFBWTtNQUNsRCxNQUFNQyxRQUFRLEdBQUcsTUFBTSxJQUFBQyxrQkFBTyxFQUFDQyxjQUFHLENBQUM7TUFDaENDLEdBQUcsQ0FBQyxjQUFjLENBQUM7TUFDbkJDLE1BQU0sQ0FBQyxHQUFHLENBQUM7O01BRWRBLE1B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